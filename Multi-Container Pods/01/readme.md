### Scenario 1: Implement Sidecar Pattern

#### Setup Script

```sh
#!/bin/bash

# Create a namespace for the exercise
kubectl create namespace ckad-scenario-4

# Deploy a sample application with a sidecar container
kubectl apply -f - <<EOF
apiVersion: v1
kind: Pod
metadata:
  name: sidecar-pod
  namespace: ckad-scenario-4
spec:
  containers:
  - name: main-app
    image: nginx
    ports:
    - containerPort: 80
  - name: sidecar
    image: busybox
    command: ['sh', '-c', 'while true; do echo "Sidecar container is running" >> /var/log/sidecar.log; sleep 5; done']
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log
  volumes:
  - name: shared-logs
    emptyDir: {}
EOF

echo "Setup complete. Your environment is ready."
```

#### Intermediate Exercise

1. Verify that the Pod named `sidecar-pod` is running in the `ckad-scenario-4` namespace.
2. Inspect the logs of the `main-app` and `sidecar` containers to verify that the sidecar container is writing logs to the shared volume.
3. Create a new Pod that mounts the same volume and reads the logs generated by the sidecar container.

##### Solution

1. Verify that the Pod named `sidecar-pod` is running:
   ```sh
   kubectl get pod sidecar-pod -n ckad-scenario-4
   ```

2. Inspect the logs of the `main-app` and `sidecar` containers:
   ```sh
   kubectl logs sidecar-pod -c main-app -n ckad-scenario-4
   kubectl logs sidecar-pod -c sidecar -n ckad-scenario-4
   ```

3. Create a new Pod that mounts the same volume and reads the logs:
   ```yaml
   apiVersion: v1
   kind: Pod
   metadata:
     name: log-reader
     namespace: ckad-scenario-4
   spec:
     containers:
     - name: log-reader
       image: busybox
       command: ['sh', '-c', 'cat /var/log/sidecar.log; sleep 3600']
       volumeMounts:
       - name: shared-logs
         mountPath: /var/log
     volumes:
     - name: shared-logs
       emptyDir: {}
   ```
   ```sh
   kubectl apply -f log-reader.yaml
   kubectl logs log-reader -n ckad-scenario-4
   ```

#### Cleanup Script

```sh
#!/bin/bash

# Delete the Pods
kubectl delete pod sidecar-pod -n ckad-scenario-4
kubectl delete pod log-reader -n ckad-scenario-4

# Delete the namespace
kubectl delete namespace ckad-scenario-4

echo "Cleanup complete. Your environment has been reset."
```

#### References and Links

- [Kubernetes Documentation](https://kubernetes.io/docs/home/)
- [Multi-Container Pods](https://kubernetes.io/docs/concepts/workloads/pods/#using-multi-container-pods)
- [Sidecar Pattern](https://kubernetes.io/docs/concepts/workloads/pods/#using-pods)

---
